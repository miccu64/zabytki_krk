<!doctype html>
<html lang="pl">

<head>

    <link rel="apple-touch-icon" href="/zdjecia/ikona/192.png">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="theme-color" content="#4c1f02">
    <meta name="Keywords" content="Kraków zabytki Krakowa zgłoś przeglądaj">
    <meta name="Description" content="Zabytki Krakowa">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="/skrypty/bootstrap.min.css">
    <script src="/skrypty/jquery-3.4.1.min.js"></script>
    <script src="/skrypty/bootstrap.min.js"></script>
    <script src="/skrypty/jquery.serializejson.min.js"></script>

    <title>Krakowskie zabytki</title>
    <link rel="icon" href="/zdjecia/ikona/16.png">
    <link rel="stylesheet" href="rejestracja.css">
    <link rel="stylesheet" href="/skrypty/wspolne.css">
    <link rel="manifest" href="/manifest.json">

</head>

<body>
    <nav class="navbar navbar-expand-sm bg-custom justify-content-left navbar-dark">
        <a class="navbar-brand" href="/">
            <img class="img-fluid" src="/zdjecia/logo_male.jpg" style="width:60px;" alt="logoWUOZ">
        </a>
        <ul class="navbar-nav mr-auto">
            <li class="nav-item">
                <a id="zalogowany2" class="nav-link linki" href="/logowanie">Logowanie</a>
            </li>
            <li class="nav-item">
                <a id="niezalogowany" class="nav-link linki" onclick="wyloguj()" href="/">Wyloguj</a>
            </li>
            <div class="collapse navbar-collapse" id="navbarSupportedContent">
                <li class="nav-item">
                    <a class="nav-link linki" href="/">Strona główna</a>
                </li>
                <li class="nav-item">
                    <a id="zalogowany3" class="nav-link linki" href="/rejestracja">Rejestracja</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link linki" href="/kontakt">Kontakt</a>
                </li>
                <script src="/skrypty/navbar.js"></script>
            </div>
        </ul>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
    </nav>

    <div class="container-xl justify-content-center align-items-center">
        <div class="row justify-content-center">
            <div class="col-12 odstep3"></div>
            <div class="col-12 col-md-6 text-center tekst">
                <div class="naglowek"><b>Rejestracja</b></div>

                <div class="col-12 odstep"></div>
                <form id="add-form">
                    <div class="form-row">
                        <div class="col-12">
                            <div class="form-group">
                                <label class="tekst odstep2" for="poczta">Adres e-mail</label>
                                <input pattern=".{6,}" title="E-mail musi zawierać co najmniej 6 znaków" type="email" class="form-control form-control-lg tekst" id="poczta" name="poczta" aria-describedby="emailHelp" required>
                            </div>
                        </div>
                        <div class="col-12">
                            <div class="form-group">
                                <label class="tekst odstep2" for="login">Nazwa użytkownika</label>
                                <input pattern=".{6,40}" title="Nazwa użytkownika musi zawierać od 6 do 40 znaków" type="text" class="form-control form-control-lg tekst" id="login" name="login" required>
                            </div>
                        </div>
                        <div class="col-12">
                            <div class="form-group">
                                <label class="tekst odstep2" for="haslo">Hasło</label>
                                <input pattern=".{8,20}" title="Hasło musi zawierać od 8 do 20 znaków" type="password" class="form-control form-control-lg tekst" id="haslo" name="haslo" required>
                            </div>
                        </div>

                        <div class="col-12">
                            <div class="form-group form-check">
                                <input type="checkbox" class="form-check-input my_checkbox" id="zaznacz" required>
                                <div class="odstep2">
                                    <p>s</p>
                                    <label class="form-check-label tekst" for="zaznacz">Oznajmiam, że zapoznałem/am się z 
                                <a href="regulamin">Regulaminem</a>
                                 i go akceptuję.</label>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="odstep2"></div>
                    <div class="row justify-content-center">
                        <div class="col-12 ">
                            <button type="submit" class="btn btn-primary btn-lg przycisk" id="zarejestruj"><b>Zarejestruj</b></button>
                            <script>
                                $('#add-form').submit(function() {
                                    klik();
                                    return false;
                                });

                                function klik() {

                                    var poczta = document.getElementById("poczta").value;
                                    var login = document.getElementById("login").value;
                                    var haslo = document.getElementById("haslo").value;
                                    var url2 = 'https://polar-chamber-44010.herokuapp.com/api/v1/user/register?email=' + poczta + '&password=' + haslo + '&name=' + login;
                                    console.log(url2);
                                    $.ajax({
                                        url: url2,
                                        type: "POST",
                                        success: function(response) {
                                            console.log(response);
                                            alert('Zarejestrowano! Teraz możesz się zalogować.');
                                            window.location.replace("/logowanie/");
                                        },
                                        error: function(error) {
                                            console.log("Something went wrong", error);
                                            alert('Taki login lub e-mail jest już zarejestrowany. Podaj inny.');
                                        }
                                    });
                                }
                            </script>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>
    <div class="footer">2020 © Wszelkie prawa zastrzeżone.</div>
</body>

</html>